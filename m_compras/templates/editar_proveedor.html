{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10">
<link rel="stylesheet" href="{% static 'css/editp.css' %}">
    <h2>Editar Proveedor</h2>
    <form method="post" action="{% url 'editar_proveedor' prov_id=provider.prov_id %}">
        {% csrf_token %}
        
        <label for="prov_name">Nombre:</label>
        {{ form.prov_name }}
        {{ form.prov_name.errors }}

        <label for="prov_dni">Cédula/RUC:</label>
        {{ form.prov_dni }}
        {{ form.prov_dni.errors }}
        
        <label for="prov_city">Ciudad:</label>
        {{ form.prov_city }}
        {{ form.prov_city.errors }}
        
        <label for="prov_type">Tipo de Proveedor:</label>
        <select name="prov_type">
            <option value="1" {% if form.prov_type.value == 1 %}selected{% endif %}>Crédito</option>
            <option value="2" {% if form.prov_type.value == 2 %}selected{% endif %}>Contado</option>
        </select>
        {{ form.prov_type.errors }}
        
        <label for="prov_address">Dirección:</label>
        {{ form.prov_address }}
        {{ form.prov_address.errors }}
        
        <label for="prov_phone">Teléfono:</label>
        {{ form.prov_phone }}
        {{ form.prov_phone.errors }}
        
        <label for="prov_email">Email:</label>
        {{ form.prov_email }}
        {{ form.prov_email.errors }}
        
        <label id="estado-label">Estado:</label>
        <input type="hidden" name="prov_status" value="0">
        <div class="form-check">
          <input type="checkbox" name="prov_status" id="prov_status_checkbox" {% if form.prov_status.value == 1 %}checked{% endif %}>
          <label for="prov_status_checkbox">Activo</label>
        </div>
        
        <button type="submit">Guardar cambios</button>
    </form>
    import logging

    logger = logging.getLogger(__name__)
    
    def insertar_proveedor(request):
        if request.method == 'POST':
            form = ProviderForm(request.POST)
            try:
                if form.is_valid():
                    form.save()
                    logger.info('Proveedor guardado exitosamente')
                    return JsonResponse({'success': True})
                else:
                    raise Exception("Formulario no válido. Corrige los errores.")
            except Exception as e:
                logger.error(f'Error al guardar proveedor: {e}')
                return JsonResponse({'success': False, 'error': str(e)})
        else:
            form = ProviderForm()
    
        return render(request, 'insertar_proveedor.html', {'form': form})

{% endblock %}

